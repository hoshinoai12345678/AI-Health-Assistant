# AIå¤§å¥åº·åŠ©æ‰‹ - WebæœåŠ¡å™¨ç‰ˆéƒ¨ç½²æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è¯¦ç»†éƒ¨ç½²æ­¥éª¤](#è¯¦ç»†éƒ¨ç½²æ­¥éª¤)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²](#ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [ç»´æŠ¤ä¸ç›‘æ§](#ç»´æŠ¤ä¸ç›‘æ§)

---

## é¡¹ç›®æ¦‚è¿°

AIå¤§å¥åº·åŠ©æ‰‹WebæœåŠ¡å™¨ç‰ˆæ˜¯åŸºäºå¾®ä¿¡å°ç¨‹åºç‰ˆæœ¬å¼€å‘çš„Webåº”ç”¨ï¼Œæä¾›ä¸å°ç¨‹åºç›¸åŒçš„åŠŸèƒ½å’Œç•Œé¢ä½“éªŒã€‚

### ä¸»è¦ç‰¹æ€§

- âœ… **å®Œæ•´åŠŸèƒ½**: åŒ…å«AIå’¨è¯¢ã€å¯¹è¯å†å²ã€ä¸ªäººä¸­å¿ƒç­‰æ‰€æœ‰åŠŸèƒ½
- âœ… **ç•Œé¢ä¸€è‡´**: ä¸å¾®ä¿¡å°ç¨‹åºä¿æŒç›¸åŒçš„UI/UXè®¾è®¡
- âœ… **ç‹¬ç«‹éƒ¨ç½²**: å•ç‹¬çš„æ–‡ä»¶å¤¹ç»“æ„ï¼Œä¸å½±å“å°ç¨‹åºä»£ç 
- âœ… **å“åº”å¼è®¾è®¡**: æ”¯æŒPCå’Œç§»åŠ¨ç«¯è®¿é—®
- âœ… **APIå¤ç”¨**: å¤ç”¨åç«¯APIæœåŠ¡ï¼Œä¿æŒæ•°æ®ä¸€è‡´æ€§

### æŠ€æœ¯æ ˆ

- **å‰ç«¯**: HTML5 + CSS3 + JavaScript (åŸç”Ÿ)
- **åç«¯**: FastAPI + Python 3.8+
- **æ•°æ®åº“**: PostgreSQL
- **ç¼“å­˜**: Redis
- **AIæœåŠ¡**: OpenAI / é€šä¹‰åƒé—®

---

## ç³»ç»Ÿè¦æ±‚

### ç¡¬ä»¶è¦æ±‚

- **CPU**: 2æ ¸å¿ƒåŠä»¥ä¸Š
- **å†…å­˜**: 4GBåŠä»¥ä¸Š
- **ç£ç›˜**: 20GBå¯ç”¨ç©ºé—´

### è½¯ä»¶è¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Linux / Windows / macOS
- **Python**: 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- **PostgreSQL**: 12.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Redis**: 6.0 æˆ–æ›´é«˜ç‰ˆæœ¬

### ç½‘ç»œè¦æ±‚

- å¼€æ”¾ç«¯å£: 9000 (WebæœåŠ¡å™¨)
- å¦‚éœ€å¤–ç½‘è®¿é—®ï¼Œéœ€é…ç½®é˜²ç«å¢™å’ŒåŸŸå

---

## å¿«é€Ÿå¼€å§‹

### Windowsç³»ç»Ÿ

1. **è¿›å…¥web-serverç›®å½•**
```bash
cd é¡¹ç›®/web-server
```

2. **è¿è¡Œå¯åŠ¨è„šæœ¬**
```bash
start.bat
```

3. **è®¿é—®åº”ç”¨**
æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:9000

### Linux/macOSç³»ç»Ÿ

1. **è¿›å…¥web-serverç›®å½•**
```bash
cd é¡¹ç›®/web-server
```

2. **æ·»åŠ æ‰§è¡Œæƒé™**
```bash
chmod +x start.sh
```

3. **è¿è¡Œå¯åŠ¨è„šæœ¬**
```bash
./start.sh
```

4. **è®¿é—®åº”ç”¨**
æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:9000

---

## è¯¦ç»†éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤1: ç¯å¢ƒå‡†å¤‡

#### 1.1 å®‰è£…Python

**Windows:**
- ä¸‹è½½Python 3.8+: https://www.python.org/downloads/
- å®‰è£…æ—¶å‹¾é€‰"Add Python to PATH"

**Linux (Ubuntu/Debian):**
```bash
sudo apt update
sudo apt install python3 python3-pip python3-venv
```

**macOS:**
```bash
brew install python@3.9
```

#### 1.2 å®‰è£…PostgreSQL

**Windows:**
- ä¸‹è½½å®‰è£…åŒ…: https://www.postgresql.org/download/windows/
- å®‰è£…ååˆ›å»ºæ•°æ®åº“

**Linux (Ubuntu/Debian):**
```bash
sudo apt install postgresql postgresql-contrib
sudo systemctl start postgresql
sudo systemctl enable postgresql
```

**åˆ›å»ºæ•°æ®åº“:**
```bash
sudo -u postgres psql
CREATE DATABASE health_db;
CREATE USER health_user WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE health_db TO health_user;
\q
```

#### 1.3 å®‰è£…Redis

**Windows:**
- ä¸‹è½½Redis for Windows: https://github.com/microsoftarchive/redis/releases
- æˆ–ä½¿ç”¨WSLå®‰è£…

**Linux (Ubuntu/Debian):**
```bash
sudo apt install redis-server
sudo systemctl start redis
sudo systemctl enable redis
```

**macOS:**
```bash
brew install redis
brew services start redis
```

### æ­¥éª¤2: é…ç½®åº”ç”¨

#### 2.1 å¤åˆ¶é…ç½®æ–‡ä»¶

```bash
cd web-server
cp env.example .env
```

#### 2.2 ç¼–è¾‘é…ç½®æ–‡ä»¶

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹å†…å®¹ï¼š

```bash
# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql+asyncpg://health_user:your_password@localhost:5432/health_db

# Redisé…ç½®
REDIS_URL=redis://localhost:6379/0

# JWTå¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹ï¼‰
SECRET_KEY=your-very-secure-secret-key-here

# AIæœåŠ¡é…ç½®ï¼ˆè‡³å°‘é…ç½®ä¸€ä¸ªï¼‰
OPENAI_API_KEY=sk-your-openai-api-key
DASHSCOPE_API_KEY=sk-your-dashscope-api-key
```

#### 2.3 ç”Ÿæˆå®‰å…¨å¯†é’¥

```python
# è¿è¡Œä»¥ä¸‹Pythonä»£ç ç”Ÿæˆå®‰å…¨å¯†é’¥
import secrets
print(secrets.token_urlsafe(32))
```

### æ­¥éª¤3: å®‰è£…ä¾èµ–

#### 3.1 åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
python -m venv venv
```

#### 3.2 æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

**Windows:**
```bash
venv\Scripts\activate
```

**Linux/macOS:**
```bash
source venv/bin/activate
```

#### 3.3 å®‰è£…PythonåŒ…

```bash
pip install -r requirements.txt
```

### æ­¥éª¤4: åˆå§‹åŒ–æ•°æ®åº“

```bash
# è¿›å…¥åç«¯ç›®å½•
cd ../backend

# è¿è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
python scripts/init_db.py

# è¿”å›web-serverç›®å½•
cd ../web-server
```

### æ­¥éª¤5: å¯åŠ¨æœåŠ¡

#### å¼€å‘ç¯å¢ƒ

```bash
python main.py
```

#### ç”Ÿäº§ç¯å¢ƒï¼ˆä½¿ç”¨Gunicornï¼‰

```bash
gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker -b 0.0.0.0:9000
```

### æ­¥éª¤6: éªŒè¯éƒ¨ç½²

1. **å¥åº·æ£€æŸ¥**
```bash
curl http://localhost:9000/health
```

2. **è®¿é—®Webç•Œé¢**
æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:9000

3. **æµ‹è¯•åŠŸèƒ½**
- æ³¨å†Œ/ç™»å½•è´¦å·
- å‘é€æµ‹è¯•æ¶ˆæ¯
- æŸ¥çœ‹å¯¹è¯å†å²

---

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡è¯¦è§£

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ | å¿…å¡« |
|--------|------|--------|------|
| APP_NAME | åº”ç”¨åç§° | AIå¤§å¥åº·åŠ©æ‰‹Webç‰ˆ | å¦ |
| DEBUG | è°ƒè¯•æ¨¡å¼ | True | å¦ |
| DATABASE_URL | æ•°æ®åº“è¿æ¥URL | - | æ˜¯ |
| REDIS_URL | Redisè¿æ¥URL | redis://localhost:6379/0 | æ˜¯ |
| SECRET_KEY | JWTå¯†é’¥ | - | æ˜¯ |
| OPENAI_API_KEY | OpenAI APIå¯†é’¥ | - | å¦* |
| DASHSCOPE_API_KEY | é€šä¹‰åƒé—®APIå¯†é’¥ | - | å¦* |
| RATE_LIMIT_PER_MINUTE | æ¯åˆ†é’Ÿè¯·æ±‚é™åˆ¶ | 100 | å¦ |

*æ³¨: OPENAI_API_KEY å’Œ DASHSCOPE_API_KEY è‡³å°‘é…ç½®ä¸€ä¸ª

### ç«¯å£é…ç½®

é»˜è®¤ç«¯å£: **9000**

ä¿®æ”¹ç«¯å£æ–¹æ³•:
```python
# ç¼–è¾‘ main.py æ–‡ä»¶
uvicorn.run(
    "main:app",
    host="0.0.0.0",
    port=9000,  # ä¿®æ”¹æ­¤å¤„
    reload=True
)
```

---

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### ä½¿ç”¨Systemd (Linux)

#### 1. åˆ›å»ºæœåŠ¡æ–‡ä»¶

```bash
sudo nano /etc/systemd/system/health-web.service
```

#### 2. æ·»åŠ ä»¥ä¸‹å†…å®¹

```ini
[Unit]
Description=AI Health Assistant Web Server
After=network.target postgresql.service redis.service

[Service]
Type=notify
User=www-data
Group=www-data
WorkingDirectory=/path/to/é¡¹ç›®/web-server
Environment="PATH=/path/to/é¡¹ç›®/web-server/venv/bin"
ExecStart=/path/to/é¡¹ç›®/web-server/venv/bin/gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker -b 0.0.0.0:9000
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

#### 3. å¯åŠ¨æœåŠ¡

```bash
sudo systemctl daemon-reload
sudo systemctl start health-web
sudo systemctl enable health-web
sudo systemctl status health-web
```

### ä½¿ç”¨Nginxåå‘ä»£ç†

#### 1. å®‰è£…Nginx

```bash
sudo apt install nginx
```

#### 2. é…ç½®Nginx

```bash
sudo nano /etc/nginx/sites-available/health-web
```

æ·»åŠ ä»¥ä¸‹é…ç½®:

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:9000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /static {
        alias /path/to/é¡¹ç›®/web-server/static;
        expires 30d;
    }
}
```

#### 3. å¯ç”¨é…ç½®

```bash
sudo ln -s /etc/nginx/sites-available/health-web /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

### é…ç½®HTTPS (Let's Encrypt)

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

### ä½¿ç”¨Dockeréƒ¨ç½²

#### 1. åˆ›å»ºDockerfile

```dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 9000

CMD ["gunicorn", "main:app", "-w", "4", "-k", "uvicorn.workers.UvicornWorker", "-b", "0.0.0.0:9000"]
```

#### 2. æ„å»ºé•œåƒ

```bash
docker build -t health-web:latest .
```

#### 3. è¿è¡Œå®¹å™¨

```bash
docker run -d \
  --name health-web \
  -p 9000:9000 \
  -e DATABASE_URL="postgresql+asyncpg://..." \
  -e REDIS_URL="redis://..." \
  -e SECRET_KEY="..." \
  health-web:latest
```

---

## å¸¸è§é—®é¢˜

### Q1: å¯åŠ¨æ—¶æç¤º"ç«¯å£å·²è¢«å ç”¨"

**è§£å†³æ–¹æ³•:**

**Windows:**
```bash
netstat -ano | findstr :9000
taskkill /PID <è¿›ç¨‹ID> /F
```

**Linux/macOS:**
```bash
lsof -i :9000
kill -9 <è¿›ç¨‹ID>
```

æˆ–ä¿®æ”¹é…ç½®ä½¿ç”¨å…¶ä»–ç«¯å£ã€‚

### Q2: æ•°æ®åº“è¿æ¥å¤±è´¥

**æ£€æŸ¥é¡¹:**
1. PostgreSQLæœåŠ¡æ˜¯å¦è¿è¡Œ
2. æ•°æ®åº“URLé…ç½®æ˜¯å¦æ­£ç¡®
3. æ•°æ®åº“ç”¨æˆ·æƒé™æ˜¯å¦è¶³å¤Ÿ
4. é˜²ç«å¢™æ˜¯å¦é˜»æ­¢è¿æ¥

**æµ‹è¯•è¿æ¥:**
```bash
psql -h localhost -U health_user -d health_db
```

### Q3: Redisè¿æ¥å¤±è´¥

**æ£€æŸ¥é¡¹:**
1. RedisæœåŠ¡æ˜¯å¦è¿è¡Œ
2. Redis URLé…ç½®æ˜¯å¦æ­£ç¡®

**æµ‹è¯•è¿æ¥:**
```bash
redis-cli ping
```

### Q4: AIæœåŠ¡è°ƒç”¨å¤±è´¥

**æ£€æŸ¥é¡¹:**
1. APIå¯†é’¥æ˜¯å¦æ­£ç¡®é…ç½®
2. ç½‘ç»œæ˜¯å¦èƒ½è®¿é—®AIæœåŠ¡
3. APIé¢åº¦æ˜¯å¦å……è¶³

### Q5: é™æ€æ–‡ä»¶æ— æ³•åŠ è½½

**è§£å†³æ–¹æ³•:**
1. æ£€æŸ¥staticç›®å½•æ˜¯å¦å­˜åœ¨
2. æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

### Q6: ç™»å½•åæ— æ³•ä¿æŒçŠ¶æ€

**è§£å†³æ–¹æ³•:**
1. æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦å¯ç”¨Cookie
2. æ£€æŸ¥JWTé…ç½®æ˜¯å¦æ­£ç¡®
3. æ¸…é™¤æµè§ˆå™¨LocalStorage

---

## ç»´æŠ¤ä¸ç›‘æ§

### æ—¥å¿—ç®¡ç†

#### æŸ¥çœ‹æ—¥å¿—

**å¼€å‘ç¯å¢ƒ:**
æ—¥å¿—ç›´æ¥è¾“å‡ºåˆ°æ§åˆ¶å°

**ç”Ÿäº§ç¯å¢ƒ (Systemd):**
```bash
sudo journalctl -u health-web -f
```

#### æ—¥å¿—è½®è½¬

åˆ›å»º `/etc/logrotate.d/health-web`:

```
/var/log/health-web/*.log {
    daily
    rotate 14
    compress
    delaycompress
    notifempty
    create 0640 www-data www-data
    sharedscripts
    postrotate
        systemctl reload health-web
    endscript
}
```

### æ€§èƒ½ç›‘æ§

#### 1. ä½¿ç”¨htopç›‘æ§èµ„æº

```bash
sudo apt install htop
htop
```

#### 2. ç›‘æ§æ•°æ®åº“

```sql
-- æŸ¥çœ‹æ´»åŠ¨è¿æ¥
SELECT * FROM pg_stat_activity;

-- æŸ¥çœ‹æ•°æ®åº“å¤§å°
SELECT pg_size_pretty(pg_database_size('health_db'));
```

#### 3. ç›‘æ§Redis

```bash
redis-cli info
redis-cli monitor
```

### å¤‡ä»½ç­–ç•¥

#### æ•°æ®åº“å¤‡ä»½

```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
cat > backup.sh << 'EOF'
#!/bin/bash
BACKUP_DIR="/backup/health-web"
DATE=$(date +%Y%m%d_%H%M%S)
mkdir -p $BACKUP_DIR

# å¤‡ä»½æ•°æ®åº“
pg_dump -U health_user health_db > $BACKUP_DIR/db_$DATE.sql

# åˆ é™¤7å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -name "db_*.sql" -mtime +7 -delete
EOF

chmod +x backup.sh
```

#### å®šæ—¶å¤‡ä»½ (Crontab)

```bash
crontab -e
# æ·»åŠ : æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½
0 2 * * * /path/to/backup.sh
```

### æ›´æ–°éƒ¨ç½²

```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç 
cd é¡¹ç›®/web-server
git pull

# 2. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# 3. æ›´æ–°ä¾èµ–
pip install -r requirements.txt --upgrade

# 4. é‡å¯æœåŠ¡
sudo systemctl restart health-web
```

### å®‰å…¨å»ºè®®

1. **å®šæœŸæ›´æ–°ä¾èµ–åŒ…**
```bash
pip list --outdated
pip install --upgrade <package-name>
```

2. **é…ç½®é˜²ç«å¢™**
```bash
sudo ufw allow 9000/tcp
sudo ufw enable
```

3. **ä½¿ç”¨HTTPS**
- é…ç½®SSLè¯ä¹¦
- å¼ºåˆ¶HTTPSé‡å®šå‘

4. **é™åˆ¶è®¿é—®**
- é…ç½®IPç™½åå•
- ä½¿ç”¨VPNè®¿é—®ç®¡ç†æ¥å£

5. **å®šæœŸå¤‡ä»½**
- æ•°æ®åº“æ¯æ—¥å¤‡ä»½
- é…ç½®æ–‡ä»¶ç‰ˆæœ¬æ§åˆ¶

---

## æŠ€æœ¯æ”¯æŒ

### æ–‡æ¡£èµ„æº

- [FastAPIå®˜æ–¹æ–‡æ¡£](https://fastapi.tiangolo.com/)
- [PostgreSQLæ–‡æ¡£](https://www.postgresql.org/docs/)
- [Redisæ–‡æ¡£](https://redis.io/documentation)

### è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»:
- æäº¤Issueåˆ°é¡¹ç›®ä»“åº“
- å‘é€é‚®ä»¶è‡³æŠ€æœ¯æ”¯æŒ

---

## é™„å½•

### ç›®å½•ç»“æ„

```
web-server/
â”œâ”€â”€ main.py                 # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ env.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ start.sh               # Linuxå¯åŠ¨è„šæœ¬
â”œâ”€â”€ start.bat              # Windowså¯åŠ¨è„šæœ¬
â”œâ”€â”€ static/                # é™æ€æ–‡ä»¶
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css     # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â””â”€â”€ app.js        # JavaScriptæ–‡ä»¶
â”‚   â””â”€â”€ images/           # å›¾ç‰‡èµ„æº
â”œâ”€â”€ templates/             # HTMLæ¨¡æ¿
â”‚   â””â”€â”€ index.html        # ä¸»é¡µé¢
â””â”€â”€ README.md             # æœ¬æ–‡æ¡£
```

### ç‰ˆæœ¬å†å²

- **v1.0.0** (2024-01-19)
  - åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
  - å®ç°æ ¸å¿ƒåŠŸèƒ½
  - å®Œæˆç•Œé¢å¼€å‘

---

**æœ€åæ›´æ–°**: 2024å¹´1æœˆ19æ—¥
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
