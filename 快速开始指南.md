# 🚀 四端数据管理功能快速开始指南

## 📝 功能概述

本系统实现了完整的四端分离数据管理：

### 🎯 四端功能对比

| 端口 | 主要功能 | 数据权限 |
|------|---------|---------|
| 👨‍🏫 **教师端** | 上传体测数据、上传动作库、查询班级数据、AI课课练 | 全部数据 |
| 🎓 **学生端** | 查询个人体测、获取训练推荐、AI咨询 | 个人数据 |
| 👨‍👩‍👧 **家长端** | 查询孩子体测、家庭训练指导、AI咨询 | 子女数据 |
| 📊 **督导端** | 数据统计、区域分析、学校对比 | 统计数据 |

## 🔧 快速部署（5分钟）

### 1️⃣ 后端部署

```bash
# 进入后端目录
cd backend

# 安装新依赖
pip install pandas==2.0.3 openpyxl==3.1.2 xlrd==2.0.1

# 初始化数据库（自动创建表）
python -c "from app.core.database import init_db; init_db()"

# 重启服务
uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

### 2️⃣ 前端部署

```bash
# 进入web-server目录
cd web-server

# 复制新文件到正确位置
# 文件已经创建好，直接重启即可

# 重启web服务
./start.sh
```

### 3️⃣ 验证部署

访问：`http://your-domain`

1. 选择"教师"角色
2. 进入"数据管理"（底部导航栏第三个图标）
3. 看到上传界面即部署成功

## 📤 数据上传步骤

### 教师端上传体测数据

1. **登录教师端**
   - 打开网站，选择"教师"角色

2. **进入数据管理**
   - 点击底部导航栏"📊 数据"

3. **上传体测数据**
   - 点击"体测数据上传"卡片中的"📤 选择文件上传"
   - 选择Excel或CSV文件（如：`模糊处理体测数据(1).csv`）
   - 等待上传完成
   - 查看成功提示：`上传成功！成功导入XX条数据`

4. **上传动作库**
   - 点击"动作库上传"卡片中的"📤 选择文件上传"
   - 选择动作库文件（如：`体育趣味课课练1260例.csv`）
   - 等待上传完成

### 数据文件格式要求

#### 体测数据必需字段：
```
学生编号, 年级, 班级名称, 性别, 身高, 体重, 
50米跑, 坐位体前屈, 一分钟跳绳, 立定跳远, 总分, 总分等级
```

#### 动作库必需字段：
```
编号, 名称, 说明, 难度等级, 适用水平, 提升体测项目
```

## 🔍 数据查询步骤

### 学生端查询

1. **选择学生角色**
   - 首页选择"🎓 学生"

2. **进入查询页面**
   - 点击底部"📊 数据"

3. **输入学号查询**
   - 输入学号（如：`092800001`）
   - 点击"🔍 查询我的数据"

4. **查看结果**
   - 基本信息（身高、体重等）
   - 各项体测成绩和等级
   - 总分和等级
   - 训练推荐（自动生成）

### 家长端查询

1. **选择家长角色**
   - 首页选择"👨‍👩‍👧 家长"

2. **进入查询页面**
   - 点击底部"📊 数据"

3. **输入孩子学号**
   - 输入孩子学号
   - 点击"🔍 查询孩子数据"

4. **查看孩子数据**
   - 显示内容与学生端相同
   - 额外提供家庭训练建议

### 教师端查询

#### 查询学生数据
1. 进入"数据管理"页面
2. 点击"👤 查询学生数据"
3. 输入学号
4. 查看详细数据和推荐

#### 查询班级数据
1. 进入"数据管理"页面
2. 点击"👥 查询班级数据"
3. 输入班级名称（如：`1班`）
4. 查看：
   - 班级总人数
   - 平均分
   - 等级分布
   - 学生列表

## 💡 使用示例

### 示例1：教师上传数据并查询

```
1. 教师登录 → 数据管理
2. 上传"模糊处理体测数据(1).csv"
3. 提示：成功导入120条数据
4. 点击"查询班级数据"
5. 输入"1班"
6. 查看班级40名学生的数据统计
```

### 示例2：学生查询个人数据

```
1. 学生登录 → 我的体测
2. 输入学号"092800001"
3. 查看个人体测成绩：
   - 总分：69.2分（及格）
   - 50米跑：30分（不及格）← 需要加强
   - 跳绳：78分（及格）
4. 查看训练推荐：
   - 推荐3个提升50米跑的动作
```

### 示例3：家长查看孩子进步

```
1. 家长登录 → 孩子体测
2. 输入孩子学号
3. 查看体测数据
4. 与AI对话："孩子50米跑不及格，在家怎么训练？"
5. 获取家庭训练方案
```

## 🎨 界面导航

### 底部导航栏（四个图标）

```
🏠 首页    💬 AI助手    📊 数据    👤 我的
```

- **首页**：角色专属功能卡片
- **AI助手**：智能对话
- **数据**：数据上传/查询（根据角色不同）
- **我的**：个人设置

### 切换角色

点击左上角角色图标 → 选择其他角色

## 📊 数据说明

### 体测等级标准

| 等级 | 分数范围 | 颜色标识 |
|------|---------|---------|
| 优秀 | 90-100 | 🟢 绿色 |
| 良好 | 80-89 | 🔵 蓝色 |
| 及格 | 60-79 | 🟡 黄色 |
| 不及格 | <60 | 🔴 红色 |

### 训练推荐逻辑

系统自动分析学生薄弱项目（得分<70分），从动作库中推荐相应训练动作：

- **50米跑不及格** → 推荐速度训练动作
- **坐位体前屈不及格** → 推荐柔韧性训练
- **跳绳不及格** → 推荐协调性训练
- **立定跳远不及格** → 推荐爆发力训练

## 🐛 常见问题解决

### Q1: 上传后提示"失败XX条"
**原因**：数据格式不正确或缺少必需字段  
**解决**：
1. 检查CSV/Excel文件编码（建议UTF-8）
2. 确保包含所有必需字段
3. 检查学生编号是否唯一

### Q2: 查询不到数据
**原因**：学号输入错误或数据未上传  
**解决**：
1. 确认学号格式正确（如：092800001）
2. 教师端确认数据已上传成功
3. 检查班级名称是否匹配

### Q3: 训练推荐为空
**原因**：动作库未上传或学生成绩都很好  
**解决**：
1. 教师端上传动作库数据
2. 如果学生各项得分都≥70，不会显示推荐

### Q4: 页面显示不完整
**原因**：浏览器缓存  
**解决**：
1. 清除浏览器缓存
2. 强制刷新（Ctrl+F5）
3. 使用无痕模式测试

## 📱 移动端使用

系统支持响应式设计，可在手机上使用：

1. 手机浏览器打开网站
2. 界面自动适配手机屏幕
3. 所有功能正常使用

## 🔐 权限说明

| 功能 | 教师 | 学生 | 家长 | 督导 |
|------|------|------|------|------|
| 上传数据 | ✅ | ❌ | ❌ | ❌ |
| 查询个人 | ✅ | ✅ | ✅ | ✅ |
| 查询班级 | ✅ | ❌ | ❌ | ✅ |
| 查询全校 | ❌ | ❌ | ❌ | ✅ |
| AI对话 | ✅ | ✅ | ✅ | ✅ |

## 📞 技术支持

遇到问题？

1. 查看《数据管理功能部署文档.md》
2. 检查后端日志：`backend/logs/`
3. 检查浏览器控制台错误
4. 联系技术支持团队

## 🎯 下一步

数据上传成功后，可以：

1. **与AI对话**
   - "帮我分析一下四年级1班的体测情况"
   - "给我一套提升50米跑的课课练方案"
   - "设计一个全员运动会方案"

2. **查看数据统计**
   - 班级平均分
   - 等级分布
   - 薄弱项目分析

3. **生成训练方案**
   - 个性化训练计划
   - 家庭锻炼指导
   - 课课练方案

---

**祝使用愉快！** 🎉

如有问题，请参考完整部署文档或联系技术支持。
